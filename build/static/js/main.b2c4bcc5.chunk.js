(this["webpackJsonpmovie-exp"]=this["webpackJsonpmovie-exp"]||[]).push([[0],{30:function(e,t,a){},31:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(8),c=a.n(s),i=a(4),o=a(5),l=a(7),u=a(6),b=a(18),h=a(15),d=a(11),j=a.n(d),p=a(13),v=a(10),m=a(9),O="https://api.themoviedb.org/3",f="12d4bba12495078b7985d986603f4fcf",g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(a,n){fetch(e,t).then((function(e){if(e.status<400)return e.json();throw e})).then((function(e){a(e)})).catch((function(e){e.json().then((function(e){n(e),console.log("Error_21: ",e)}))}))}))},x=a(2),y=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={username:"",password:"",errors:{},submitting:!1},e.onChange=function(t){var a=t.target.name,n=t.target.value;e.setState((function(e){var t;return t={},Object(v.a)(t,a,n),Object(v.a)(t,"errors",Object(m.a)(Object(m.a)({},e.errors),{},Object(v.a)({base:null},a,null))),t}))},e.handleBlur=function(){var t=e.validateFields();Object.keys(t).length>0&&e.setState((function(e){return{errors:Object(m.a)(Object(m.a)({},e.errors),t)}}))},e.validateFields=function(){var t={};return""===e.state.username&&(t.username="\u041f\u043e\u043b\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c"),t},e.onSubmit=Object(p.a)(j.a.mark((function t(){var a,n,r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.setState({submitting:!0}),t.next=4,g("".concat(O,"/authentication/token/new?api_key=").concat(f));case 4:return a=t.sent,t.next=7,g("".concat(O,"/authentication/token/validate_with_login?api_key=").concat(f),{method:"POST",mode:"cors",headers:{"Content-type":"application/json"},body:JSON.stringify({username:e.state.username,password:e.state.password,request_token:a.request_token})});case 7:return n=t.sent,t.next=10,g("".concat(O,"/authentication/session/new?api_key=").concat(f),{method:"POST",mode:"cors",headers:{"Content-type":"application/json"},body:JSON.stringify({request_token:n.request_token})}).then((function(t){return e.props.updateSessionId(t.session_id),g("".concat(O,"/account?api_key=").concat(f,"&session_id=").concat(t.session_id))})).then((function(t){e.props.updateUser(t),e.setState({submitting:!1})}));case 10:r=t.sent,r.session_id,t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),e.setState({submitting:!1,errors:{base:t.t0.status_message}});case 17:case"end":return t.stop()}}),t,null,[[0,14]])}))),e.onLogin=function(t){t.preventDefault();var a=e.validateFields();Object.keys(a).length>0?e.setState((function(e){return{errors:Object(m.a)(Object(m.a)({},e.errors),a)}})):e.onSubmit()},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this.state,t=e.username,a=e.password,n=e.errors,r=e.submitting;return Object(x.jsx)("div",{className:"form-login-container",children:Object(x.jsxs)("form",{className:"form-login",children:[Object(x.jsx)("h1",{className:"h3 mb-3 font-weight-normal text-center",children:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"username",children:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c"}),Object(x.jsx)("input",{type:"text",className:"form-control",id:"username",placeholder:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c",name:"username",value:t,onChange:this.onChange,onBlur:this.handleBlur}),n.username&&Object(x.jsx)("div",{className:"invalid-feedback",children:n.username})]}),Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"password",children:"\u041f\u0430\u0440\u043e\u043b\u044c"}),Object(x.jsx)("input",{type:"password",className:"form-control",id:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",name:"password",value:a,onChange:this.onChange}),n.password&&Object(x.jsx)("div",{className:"invalid-feedback",children:n.password})]}),Object(x.jsx)("button",{type:"submit",className:"btn btn-lg btn-primary btn-block",onClick:this.onLogin,disabled:r,children:"\u0412\u0445\u043e\u0434"}),n.base&&Object(x.jsx)("div",{className:"invalid-feedback",children:n.base})]})})}}]),a}(n.Component),_=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).toggleModal=function(){e.setState((function(e){return{showModal:!e.showModal}}))},e.state={showModal:!1},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props,t=e.updateUser,a=e.updateSessionId;return Object(x.jsxs)("div",{children:[Object(x.jsx)("button",{className:"btn btn-success",type:"button",onClick:this.toggleModal,children:"\u0412\u043e\u0439\u0442\u0438"}),Object(x.jsx)(h.a,{isOpen:this.state.showModal,toggle:this.toggleModal,children:Object(x.jsx)(h.b,{children:Object(x.jsx)(y,{updateUser:t,updateSessionId:a})})})]})}}]),a}(n.Component),k=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props.user;return Object(x.jsx)("div",{children:Object(x.jsx)("img",{width:"40",className:"rounded-circle",src:"https://secure.gravatar.com/avatar/".concat(e.avatar.gravatar.hash,".jpg?s=32")})})}}]),a}(n.Component),C=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props,t=e.user,a=e.updateUser,n=e.updateSessionId;return Object(x.jsx)("nav",{className:"navbar navbar-dark bg-primary",children:Object(x.jsxs)("div",{className:"container",children:[Object(x.jsx)("ul",{className:"navbar-nav",children:Object(x.jsx)("li",{className:"nav-item active",children:Object(x.jsx)("a",{className:"nav-link",children:"\u0414\u043e\u043c\u043e\u0439"})})}),t?Object(x.jsx)(k,{user:t}):Object(x.jsx)(_,{updateUser:a,updateSessionId:n})]})})}}]),a}(n.Component),N=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props,t=e.sort_by,a=e.onChangeFilters,n=e.options;return Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:"sort_by",children:"\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e:"}),Object(x.jsx)("select",{id:"sort_by",name:"sort_by",className:"from-control",value:t,onChange:a,children:n.map((function(e){var t=e.value,a=e.label;return Object(x.jsx)("option",{value:t,children:a},t)}))})]})}}]),a}(n.Component);N.defaultProps={options:[{label:"\u041f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u043e\u0435 \u043f\u043e \u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e",value:"popularity.desc"},{label:"\u041f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u043e\u0435 \u043f\u043e \u0432\u043e\u0437\u0440\u0430\u0441\u0442\u0430\u043d\u0438\u044e",value:"popularity.asc"},{label:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433 \u043f\u043e \u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e",value:"vote_average.desc"},{label:"\u0420\u0435\u0439\u0442\u0438\u043d\u0433 \u043f\u043e \u0432\u043e\u0437\u0440\u0430\u0441\u0442\u0430\u043d\u0438\u044e",value:"vote_average.asc"}]};var w=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props,t=e.onClick,a=e.title,n=e.disabled;return Object(x.jsx)("button",{type:"button",className:"btn btn-light",onClick:t,disabled:n,children:a})}}]),a}(n.Component),S=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props,t=e.id,a=e.name,n=e.value,r=e.onChange,s=e.labelText,c=e.children;return Object(x.jsxs)("div",{className:"form-group",children:[Object(x.jsx)("label",{htmlFor:t,children:s}),Object(x.jsx)("select",{id:t,className:"form-control",name:a,value:n,onChange:r,children:c})]})}}]),a}(n.Component),F=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props,t=e.page,a=e.primary_release_year,n=e.onChangePagination,r=e.onChangeFilters,s=e.options,c=e.total_pages;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(S,{id:"primary_release_year",name:"primary_release_year",value:a,onChange:r,labelText:"\u0413\u043e\u0434 \u0440\u0435\u043b\u0438\u0437\u0430",children:s.map((function(e){var t=e.value,a=e.label;return Object(x.jsx)("option",{value:t,children:a},t)}))}),Object(x.jsx)(w,{page:t,title:"\u041d\u0430\u0437\u0430\u0434",onClick:n.bind(null,t-1),disabled:1===t}),Object(x.jsx)(w,{page:t,title:"\u0412\u043f\u0435\u0440\u0435\u0434",onClick:n.bind(null,t+1),disabled:t===c})]})}}]),a}(n.Component);F.defaultProps={options:[{label:"2018",value:"2018"},{label:"2017",value:"2017"},{label:"2020",value:"2020"},{label:"2021",value:"2021"}]};var P=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props,t=e.id,a=e.name;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("input",{className:"form-check-input",type:"checkbox",value:"",id:t}),Object(x.jsx)("label",{className:"form-check-label",htmlFor:t,children:a}),Object(x.jsx)("br",{})]})}}]),a}(n.Component),M=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).getGeners=Object(p.a)(j.a.mark((function t(){var a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a="".concat(O,"/genre/movie/list?api_key=").concat(f,"&language=ru-RU"),t.next=3,fetch(a).then((function(e){return e.json()})).then((function(t){e.setState({allGeners:t})}));case 3:case"end":return t.stop()}}),t)}))),e.state={allGeners:[]},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.getGeners()}},{key:"render",value:function(){var e=this.state.allGeners,t=[];for(var a in e)e[a].map((function(e){return t.push(e)}));return Object(x.jsx)("div",{className:"form-check",children:t.map((function(e){var t=e.id,a=e.name;return Object(x.jsx)(P,{id:t,name:a},t)}))})}}]),a}(n.Component),U=function(){return Object(x.jsx)(J.Consumer,{children:function(e){return Object(x.jsx)(M,{allGeners:e})}})},I=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props,t=e.filters,a=t.sort_by,n=t.primary_release_year,r=t.with_genres,s=e.page,c=e.total_pages,i=e.onChangeFilters,o=e.onChangePagination;return Object(x.jsxs)("form",{className:"mb-3",children:[Object(x.jsx)(N,{value:a,onChangeFilters:i}),Object(x.jsx)(U,{with_genres:r,onChangeFilters:i}),Object(x.jsx)(F,{page:s,total_pages:c,onChangePagination:o,onChangeFilters:i,primary_release_year:n})]})}}]),a}(n.Component),D=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props.item;return Object(x.jsxs)("div",{className:"card",style:{width:"100%"},children:[Object(x.jsx)("img",{className:"card-img-top card-img--height",src:"https://image.tmdb.org/t/p/w500".concat(e.backdrop_path||e.poster_path),alt:"poster"}),Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h6",{className:"card-title",children:e.title}),Object(x.jsxs)("div",{className:"card-text",children:["\u0420\u0435\u0439\u0442\u0438\u043d\u0433: ",e.vote_average]}),Object(x.jsxs)("div",{className:"card-text",children:["\u0420\u0435\u043b\u0438\u0437: ",e.release_date]})]})]})}}]),a}(n.Component),G=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).getMovies=function(t,a){var n=t.sort_by,r="".concat(O,"/discover/movie?api_key=").concat(f,"&language=ru-RU&sort_by=").concat(n,"&page=").concat(a);fetch(r).then((function(e){return e.json()})).then((function(t){e.setState({movies:t.results})}))},e.getReleaseDate=function(){var t=e.state.movies,a=[],n=[];t.forEach((function(e){var t=e.release_date;a.push(t.substring(0,4))}));var r=a.filter((function(e,t,a){return a.indexOf(e)===t}));return n.push(r),n},e.state={movies:[],releases_on_page:{}},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.getMovies(this.props.filters,this.props.page)}},{key:"componentDidUpdate",value:function(e){this.props.filters.sort_by!==e.filters.sort_by&&(this.props.onChangePagination(1),this.getMovies(this.props.filters,1)),this.props.page!==e.page&&this.getMovies(this.props.filters,this.props.page),this.state.releases_on_page=this.getReleaseDate()}},{key:"render",value:function(){var e=this.state.movies;return Object(x.jsx)("div",{className:"row",children:e&&e.map((function(e){return Object(x.jsx)("div",{className:"col-6 mb-4",children:Object(x.jsx)(D,{item:e})},e.id)}))})}}]),a}(n.Component),q=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).onChangeFilters=function(t){var a=t.target.value,n=t.target.name;e.setState((function(e){return{filters:Object(m.a)(Object(m.a)({},e.filters),{},Object(v.a)({},n,a))}}))},e.onChangePagination=function(t){e.setState({page:t,total_pages:e.state.total_pages})},e.state={filters:{sort_by:"popularity.desc",primary_release_year:"2019",with_geners:[1]},page:1,total_pages:500},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this.state,t=e.filters,a=e.page,n=e.total_pages,r=e.with_genres,s=this.state.filters.primary_release_year;return Object(x.jsx)(x.Fragment,{children:Object(x.jsx)("div",{className:"container",children:Object(x.jsxs)("div",{className:"row mt-4",children:[Object(x.jsx)("div",{className:"col-4",children:Object(x.jsx)("div",{className:"card",style:{width:"100%"},children:Object(x.jsxs)("div",{className:"card-body",children:[Object(x.jsx)("h3",{children:"\u0424\u0438\u043b\u044c\u0442\u0440\u044b"}),Object(x.jsx)(I,{page:a,filters:t,total_pages:n,with_genres:r,primary_release_year:s,onChangeFilters:this.onChangeFilters,onChangePagination:this.onChangePagination})]})})}),Object(x.jsx)("div",{className:"col-8",children:Object(x.jsx)(G,{filters:t,page:a,onChangePagination:this.onChangePagination,onChangeFilters:this.onChangeFilters,primary_release_year:t.primary_release_year})})]})})})}}]),a}(n.Component),B=new b.a,J=r.a.createContext(),R=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).updateUser=function(t){e.setState({user:t})},e.updateSessionId=function(t){B.set("session_id",t,{path:"/",maxAge:2592e3}),e.setState({session_id:t})},e.state={user:null,session_id:null,filters:{sort_by:"popularity.desc",primary_release_year:"2019",with_geners:[1]},page:1,total_pages:500},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=B.get("session_id");t&&g("".concat(O,"/account?api_key=").concat(f,"&session_id=").concat(t)).then((function(t){e.updateUser(t)}))}},{key:"render",value:function(){var e=this.state.user;return Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)(J.Provider,{value:this.state.filters.with_geners,children:[Object(x.jsx)(C,{user:e,updateUser:this.updateUser,updateSessionId:this.updateSessionId}),Object(x.jsx)(q,{})]})})}}]),a}(n.Component);a(29),a(30);c.a.render(Object(x.jsx)(R,{}),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.b2c4bcc5.chunk.js.map